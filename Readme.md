## 需求

输入：一个关键字；

输出：一个视频的列表；

## 实现流程

1. 先用关键字去爬取YouTube五分钟内的视频，将视频保存至本地；
2. 对于其中一个视频而言，按照如下方法进行计算：
   1. 子视频：使用FFmpeg或者OpenCV对其进行分帧（假设10秒一帧），这一步可以得到一个子视频的临时文件夹；
   2. 抽取：对于每一个子视频抽帧，这一步可以得到一个临时帧数组；
   3. 识别：对每一帧进行人脸识别，得到一个bbox，计算该bbox的面积，近似于人脸面积。
   4. 判断：对于每一帧，计算其人脸大小面积是否全部超过设定的阈值，假设为：10cm2；
   5. 持久化：对于符合条件的帧，保存到本地；

## 技术栈

- 面向YouTube爬虫（selenium）
- OpenCV分帧（cv2）
- 人脸识别API: 使用开源库：`face_recognition`对图像中的人脸进行检测和定位：https://github.com/ageitgey/face_recognition/blob/master/README_Simplified_Chinese.md

## 遇到问题

#### FFMPEG无法解码

```
FFMPEG: tag 0x47504a4d/'MJPG' is not supported with codec id 7 and format 'mp4 / MP4 (MPEG-4 Part 14)
```

解决：转换成mp4v即可；

#### selenium打开网页后不运行脚本

原因：PyCache缓存导致，删除缓存即可。

#### 下载到第五个视频的时候，网速明显下降

可能是网站的反爬虫机制，暂时难以解决。

#### 需求不明确

1. 只需要提取视频长度为5min以内的？
2. 视频中如果出现多个人脸，只要有一个大于阈值，就判定为有效？（**当前逻辑**）

## For Debug

- 每次只爬取一批视频，每批最多只下载五个视频

## GitHub

https://github.com/GaryGky/spyder

## 说明文案

```
1. 第一步，对爬虫过程进行简单的展示，从YouTube爬取视频有两种方法，一种是通过URL获取视频文件，一种是利用videoid，在这个demo中使用第二种方式，并配合工具youtube-dl 对视频进行下载；
（为简单起见，这里每次只拉取一批videoid，每一批只下载三个视频进行演示使用）。

2. 第二步，对下载好视频文件，随机挑选一个进行视频处理过程演示。

3. 第三步，首先把一个视频按照10秒划分为若干个子集；然后对于每一个子集抽帧进行人脸识别，按照如下算法计算该子集是否有效：
	1. 存在人脸
	2. 存在的人脸面积，至少有一块是大于阈值的。

4. 删除不符合条件的子集，保留满足条件的子集。
```

